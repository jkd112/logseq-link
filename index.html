<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Przekierowanie Linków</title>
    <script>
        function doRedirect() {
            const currentUrl = window.location.href;
            
            // Szukamy logseq:// lub message://
            const protocols = ["logseq://", "message://"];
            let targetLink = null;

            for (let p of protocols) {
                if (currentUrl.indexOf(p) !== -1) {
                    targetLink = decodeURIComponent(currentUrl.substring(currentUrl.indexOf(p)));
                    break;
                }
            }

            if (targetLink) {
                // Próba 1: Standardowa
                window.location.assign(targetLink);

                // Próba 2: Przez niewidoczną ramkę (skuteczne w Chrome dla message://)
                setTimeout(function() {
                    const iframe = document.createElement("iframe");
                    iframe.style.display = "none";
                    iframe.src = targetLink;
                    document.body.appendChild(iframe);
                }, 200);

                // Próba 3: Symulacja kliknięcia
                setTimeout(function() {
                    const a = document.createElement('a');
                    a.href = targetLink;
                    a.click();
                }, 400);
            }
        }
        window.onload = doRedirect;
    </script>
</head>
<body>
    <div style="text-align: center; margin-top: 50px; font-family: sans-serif;">
        <p>Otwieranie aplikacji...</p>
        <button onclick="doRedirect()" style="padding: 10px 20px; cursor: pointer;">Kliknij tutaj, jeśli Mail się nie otwiera</button>
    </div>
</body>
</html>
