<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Przekierowanie Linków</title>
    <script>
        function doRedirect() {
            const currentUrl = window.location.href;
            
            // Szukamy początku jakiegokolwiek protokołu po znaku zapytania
            // Szuka logseq:// lub message://
            const protocols = ["logseq://", "message://"];
            let targetLink = null;

            for (let p of protocols) {
                if (currentUrl.indexOf(p) !== -1) {
                    targetLink = decodeURIComponent(currentUrl.substring(currentUrl.indexOf(p)));
                    break;
                }
            }

            if (targetLink) {
                // Próba otwarcia
                window.location.href = targetLink;

                // Rezerwa dla Chrome/Brave
                setTimeout(function() {
                    const a = document.createElement('a');
                    a.href = targetLink;
                    a.click();
                }, 100);
            } else {
                document.body.innerHTML = "<h3>Nie znaleziono obsługiwanego linku.</h3><p>Obsługiwane: Logseq, Apple Mail (message://)</p>";
            }
        }
        window.onload = doRedirect;
    </script>
</head>
<body>
    <div style="text-align: center; margin-top: 50px; font-family: sans-serif;">
        <p>Otwieranie aplikacji...</p>
        <button onclick="doRedirect()" style="padding: 10px 20px; cursor: pointer;">Kliknij tutaj, jeśli aplikacja się nie otwiera</button>
    </div>
</body>
</html>
