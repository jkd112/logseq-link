<script>
    window.onload = function() {
        const url = window.location.href;
        const mailIndex = url.indexOf("message://");

        if (mailIndex !== -1) {
            // Wycinamy link, ale NIE używamy decodeURIComponent na tym etapie,
            // bo Skróty same sobie z tym poradzą lepiej.
            const mailLink = url.substring(mailIndex);
            
            const shortcutName = "OtworzMaila";
            // Budujemy URL do skrótu
            const finalShortcutUrl = "shortcuts://run-shortcut?name=" + encodeURIComponent(shortcutName) + "&input=" + encodeURIComponent(mailLink);
            
            window.location.href = finalShortcutUrl;
        }
    };
</script>
